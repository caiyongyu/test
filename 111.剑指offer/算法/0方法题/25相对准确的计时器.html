<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        var period = 60 * 1000 * 60 * 2
        var startTime = new Date().getTime();
        var count = 0
        var end = new Date().getTime() + period
        var interval = 1000
        var currentInterval = interval
        
        function loop() {
            count++
            var offset = new Date().getTime() - (startTime + count * interval); // 代码执行所消耗的时间
            var diff = end - new Date().getTime()
            var h = Math.floor(diff / (60 * 1000 * 60))
            var hdiff = diff % (60 * 1000 * 60)
            var m = Math.floor(hdiff / (60 * 1000))
            var mdiff = hdiff % (60 * 1000)
            var s = mdiff / (1000)
            var sCeil = Math.ceil(s)
            var sFloor = Math.floor(s)
            currentInterval = interval - offset // 得到下一次循环所消耗的时间
            console.log('时：'+h, '分：'+m, '毫秒：'+s, '秒向上取整：'+sCeil, '代码执行时间：'+offset, '下次循环间隔'+currentInterval) // 打印 时 分 秒 代码执行时间 下次循环间隔
            
            setTimeout(loop, currentInterval)
        }
        
        setTimeout(loop, currentInterval)
    </script>
</body>
</html>