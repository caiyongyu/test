<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        //创建数据库连接对象
        var conn = new XMLHttpRequest("ADODB.Connection");
        // var conn = new ActiveXObject("ADODB.Connection");
        //创建数据集对象
        var rs = new XMLHttpRequest("ADODB.Recordset");
        try{
        
        var connectionstring = "Driver={MySQL ODBC 8.0 ANSI Driver};Server=127.0.0.1;User=root;Password=123456;Database=shop;Option=3;Port=3306";
        console.log(connectionstring);
        //打开连接
        conn.open(connectionstring);
          
        //查询语句
        var sql = " select * from rolemenu ";
        //打开数据集（即执行查询语句）
        rs.open(sql,conn);
        //(或者rs=conn.execute(sql);)
        //遍历所有记录
        while(!rs.eof){
         //WScript是Windows 的脚本宿主对象，详细情况请在windows帮助里查找。
         //WScript.Echo输出记录的内容
        // document.write(rs.Fields("id") + "\t" + rs.Fields("xueke") + "\n");
        console.log(rs.eof)
          
         //下一条记录
         rs.moveNext();
        }
        //关闭记录集
        rs.close();
        //关闭数据库连接
        conn.close();
        } catch(e){
        //异常报告
        document.write(e.message);
        } finally{
        //
        }
        </script>


        
        <!-- php版：
        
        <html>
        <body>
        <?php
        //第一个参数是图片红色框体的自定义名称。注意
        $conn=odbc_connect('mysqlodbc','root','root');
        if (!$conn)
        {
        exit("连接失败: " . $conn);
        }
        
        
        $sql="SELECT * FROM su_ceshi";
        $rs=odbc_exec($conn,$sql);
        
        
        if (!$rs)
        {
        exit("SQL 语句错误");
        }
        echo "<table><tr>";
        echo "<th>id</th>";
        echo "<th>xueke</th></tr>";
        
        
        while (odbc_fetch_row($rs))
        {
        $compname=odbc_result($rs,"id");
        $conname=odbc_result($rs,"xueke");
        echo "<tr><td>$compname</td>";
        echo "<td>$conname</td></tr>";
        }
        odbc_close($conn);
        echo "</table>";
        ?>
       </<script> -->
</body>
</html>